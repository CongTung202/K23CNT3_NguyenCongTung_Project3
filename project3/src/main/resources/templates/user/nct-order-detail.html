<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${nctPageTitle}">Chi tiết đơn hàng</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
        }
        header { background-color: #fff; border-bottom: 1px solid #e0e0e0; padding: 12px 20px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 50; height: 60px; }
        .logo { font-size: 20px; font-weight: bold; display: flex; align-items: center; gap: 2px; }
        .logo .red { color: #ff3333; }
        .logo .black { color: #000; }
        .sidebar { position: fixed; left: 0; top: 60px; width: 250px; height: calc(100vh - 60px); background-color: #fff; border-right: 1px solid #e0e0e0; padding: 20px 0; z-index: 40; }
        .sidebar-item { padding: 12px 20px; color: #333; text-decoration: none; display: flex; align-items: center; gap: 12px; font-size: 14px; transition: all 0.3s ease; border-left: 3px solid transparent; }
        .sidebar-item:hover, .sidebar-item.active { background-color: #f0f0f0; color: #ff3333; border-left-color: #ff3333; }
        .sidebar-item i { font-size: 16px; }
        .main-content { margin-left: 250px; padding: 20px; }
        .page-header { background-color: #fff; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .page-header h1 { font-size: 24px; font-weight: bold; color: #000; }
        footer { background-color: #1a1a1a; color: #fff; padding: 40px 20px; margin-top: 60px; margin-left: 250px; }
        footer h3 { font-size: 14px; font-weight: bold; margin-bottom: 15px; }
        footer a { color: #ccc; text-decoration: none; font-size: 13px; transition: color 0.3s; }
        footer a:hover { color: #fff; }
        .footer-section { margin-bottom: 30px; }
        .footer-info { display: flex; align-items: flex-start; gap: 10px; margin-bottom: 12px; font-size: 13px; color: #ccc; }
        .footer-info i { margin-top: 2px; }
    </style>
</head>
<body>
<div th:replace="~{fragments/nct-header :: header}"></div>
<div th:replace="~{fragments/nct-sidebar :: sidebar(activePage='orders')}"></div>

<main class="main-content">
    <div class="page-header flex justify-between items-center">
        <h1>Chi tiết đơn hàng #<span th:text="${nctOrder.nctOrderId}"></span></h1>
        <a th:href="@{/orders}" class="text-sm text-gray-600 hover:text-red-500 transition-colors">
            <i class="fas fa-arrow-left mr-2"></i>Quay lại danh sách
        </a>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Order Details -->
        <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-bold mb-4 border-b pb-3">Sản phẩm trong đơn hàng</h2>
            <div th:each="item : ${nctOrder.nctOrderItems}" class="flex items-center py-4 border-b last:border-b-0">
                <img th:src="@{${item.nctProduct.nctImageUrl}}" alt="Product Image" class="w-20 h-20 object-cover rounded-md mr-4">
                <div class="flex-grow">
                    <p class="font-semibold text-gray-800" th:text="${item.nctProduct.nctProductName}"></p>
                    <p class="text-sm text-gray-500">Số lượng: <span th:text="${item.nctQuantity}"></span></p>
                </div>
                <div class="text-right">
                    <p class="font-semibold text-gray-800" th:text="|₫${#numbers.formatDecimal(item.nctPrice, 0, 'COMMA', 0, 'POINT')}|"></p>
                    <p class="text-sm text-gray-500">Thành tiền: <span class="font-medium" th:text="|₫${#numbers.formatDecimal(item.nctPrice.multiply(new java.math.BigDecimal(item.nctQuantity)), 0, 'COMMA', 0, 'POINT')}|"></span></p>
                </div>
            </div>
        </div>

        <!-- Order Summary -->
        <div class="bg-white p-6 rounded-lg shadow-md h-fit">
            <h2 class="text-xl font-bold mb-4 border-b pb-3">Thông tin đơn hàng</h2>
            <div class="space-y-3 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">Mã đơn hàng:</span>
                    <span class="font-semibold text-gray-800" th:text="'#' + ${nctOrder.nctOrderId}"></span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Ngày đặt:</span>
                    <span class="font-semibold text-gray-800" th:text="${#temporals.format(nctOrder.nctCreatedAt, 'dd/MM/yyyy HH:mm')}"></span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-600">Trạng thái:</span>
                    <span class="text-xs font-semibold py-1 px-3 rounded-full uppercase"
                          th:text="${nctOrder.getNctStatusDisplayName()}"
                          th:classappend="${nctOrder.nctStatus.name() == 'PENDING' ? 'bg-yellow-100 text-yellow-800' :
                                           (nctOrder.nctStatus.name() == 'DELIVERED' ? 'bg-green-100 text-green-800' :
                                           (nctOrder.nctStatus.name() == 'CANCELLED' ? 'bg-red-100 text-red-800' :
                                           (nctOrder.nctStatus.name() == 'SHIPPING' ? 'bg-blue-100 text-blue-800' :
                                           (nctOrder.nctStatus.name() == 'CONFIRMED' ? 'bg-indigo-100 text-indigo-800' : 'bg-gray-100 text-gray-800'))))}">
                    </span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Thanh toán:</span>
                    <span class="font-semibold text-gray-800" th:text="${nctOrder.getNctPaymentMethodDisplayName()}"></span>
                </div>
            </div>

            <hr class="my-4">

            <h3 class="text-lg font-bold mb-3">Địa chỉ giao hàng</h3>
            <div class="text-sm text-gray-700 space-y-1">
                <p th:text="${nctOrder.nctUser.nctFullName}"></p>
                <p th:text="${nctOrder.nctShippingAddress}"></p>
                <p th:text="${nctOrder.nctPhone}"></p>
            </div>

            <hr class="my-4">

            <div class="flex justify-between items-center text-lg">
                <span class="font-semibold">Tổng cộng:</span>
                <span class="text-red-500 font-bold" th:text="|₫${#numbers.formatDecimal(nctOrder.nctTotalAmount, 0, 'COMMA', 0, 'POINT')}|"></span>
            </div>
        </div>
    </div>
</main>

<footer class="mt-auto">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
        <div class="footer-section">
            <h3>Thông tin UMACT.vn</h3>
            <div class="footer-info">
                <i class="fas fa-map-marker-alt"></i>
                <span>Số 157, Phố Xốm, Phú Lãm, Hà Đông, Hà Nội</span>
            </div>
            <div class="footer-info">
                <i class="fas fa-envelope"></i>
                <span>UMACT@gmail.com</span>
            </div>
            <div class="footer-info">
                <i class="fas fa-phone"></i>
                <span>Hotline: 0334402527</span>
            </div>
        </div>
        <div class="footer-section">
            <h3>Chính sách chung</h3>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <a href="#">Chính sách bảo mật</a>
                <a href="#">Chính sách bảo hành & đổi trả</a>
                <a href="#">Các câu hỏi thường gặp</a>
                <a href="#">Liên hệ với chúng tôi</a>
            </div>
        </div>
    </div>
    <div style="border-top: 1px solid #333; padding-top: 20px; text-align: center; font-size: 13px; color: #999;">
        <p>Copyright © 2025 <span style="color: #fff; font-weight: bold;">UMACT.vn</span> • Developed by <span style="color: #ccc;">CongTung202</span></p>
    </div>
</footer>

</body>
</html>
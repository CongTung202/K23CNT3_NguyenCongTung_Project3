<!DOCTYPE html>
       <html lang="vi" xmlns:th="http://www.thymeleaf.org">
       <head>
           <meta charset="UTF-8">
           <title th:text="${nctPageTitle}">Danh sách yêu thích</title>
           <meta name="viewport" content="width=device-width, initial-scale=1.0">
           <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
           <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
           <style>
               body {
                   font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                   background-color: #f5f5f5;
               }
                       /* Header */
        header {
            background-color: #fff;
            border-bottom: 1px solid #e0e0e0;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 50;
            height: 60px;
        }

        .logo {
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .logo .red { color: #ff3333; }
        .logo .black { color: #000; }
               .sidebar {
                   position: fixed; left: 0; top: 60px; width: 250px; height: calc(100vh - 60px);
                   background-color: #fff; border-right: 1px solid #e0e0e0; padding: 20px 0; z-index: 40;
               }
               .sidebar-item {
                   padding: 12px 20px; color: #333; text-decoration: none; display: flex;
                   align-items: center; gap: 12px; font-size: 14px; transition: all 0.3s ease;
                   border-left: 3px solid transparent;
               }
               .sidebar-item:hover, .sidebar-item.active {
                   background-color: #ffe0e0; color: #ff3333; border-left-color: #ff3333;
               }
               .sidebar-item i { font-size: 16px; }
               .main-content { margin-left: 250px; padding: 20px; }
               .wishlist-item {
                   display: flex;
                   align-items: center;
                   gap: 16px;
                   padding: 16px;
                   border-bottom: 1px solid #e5e7eb;
               }
               .wishlist-item:last-child { border-bottom: none; }
               .item-actions {
                   margin-left: auto;
                   display: flex;
                   gap: 12px;
               }
               .action-btn {
                   background: none;
                   border: 1px solid #ddd;
                   border-radius: 50%;
                   width: 40px;
                   height: 40px;
                   cursor: pointer;
                   display: flex;
                   align-items: center;
                   justify-content: center;
                   transition: all 0.3s ease;
                   color: #666;
               }
               .action-btn:hover {
                   border-color: #ff3333;
                   color: #ff3333;
                   background-color: #fff5f5;
               }
               .empty-state {
                   text-align: center; padding: 60px 20px; background-color: #fff; border-radius: 8px;
               }
               .empty-state i { font-size: 48px; color: #ddd; margin-bottom: 20px; }
               .empty-state p { color: #999; font-size: 16px; margin-bottom: 20px; }
               .empty-state a {
                   display: inline-block; padding: 10px 24px; background-color: #ff3333; color: white;
                   text-decoration: none; border-radius: 6px; transition: all 0.3s ease;
               }
               .empty-state a:hover { background-color: #e60000; }

               @media (max-width: 768px) {
                   .main-content { margin-left: 0; }
                   .sidebar { display: none; }
                   .wishlist-item { flex-direction: column; align-items: flex-start; }
                   .item-actions { margin-left: 0; margin-top: 16px; width: 100%; justify-content: flex-end; }
               }
           </style>
       </head>
       <body>

       <!-- Header -->
       <div th:replace="~{fragments/nct-header :: header}"></div>

       <!-- Sidebar -->
       <div th:replace="~{fragments/nct-sidebar :: sidebar(activePage='bookmark')}"></div>

       <!-- Main Content -->
       <main class="main-content">
           <h1 class="text-2xl font-bold text-gray-800 mb-6">Danh sách yêu thích</h1>

           <!-- Success/Error Messages -->
           <div th:if="${successMessage}" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
               <span class="block sm:inline" th:text="${successMessage}"></span>
           </div>
           <div th:if="${errorMessage}" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
               <span class="block sm:inline" th:text="${errorMessage}"></span>
           </div>

           <!-- Empty Wishlist -->
           <div th:if="${wishlistItems == null or #lists.isEmpty(wishlistItems)}" class="empty-state">
               <i class="far fa-heart"></i>
               <p>Danh sách yêu thích của bạn đang trống.</p>
               <a th:href="@{/products}">Khám phá sản phẩm</a>
           </div>

           <!-- Wishlist with Items -->
           <div th:if="${wishlistItems != null and not #lists.isEmpty(wishlistItems)}" class="bg-white rounded-lg shadow-md overflow-hidden">
               <!-- Wishlist Item Loop -->
               <div th:each="item : ${wishlistItems}" class="wishlist-item">
                   <!-- Product Image -->
                   <a th:href="@{/products/{id}(id=${item.nctProduct.nctProductId})}">
                       <img th:src="${item.nctProduct.nctImageUrl}" th:alt="${item.nctProduct.nctProductName}" class="w-24 h-24 object-cover rounded-md">
                   </a>

                   <!-- Product Info -->
                   <div class="flex-grow">
                       <a th:href="@{/products/{id}(id=${item.nctProduct.nctProductId})}" class="text-gray-800 font-semibold hover:text-red-500 no-underline" th:text="${item.nctProduct.nctProductName}"></a>
                       <p class="text-red-500 font-bold mt-2" th:text="|₫ ${#numbers.formatDecimal(item.nctProduct.nctPrice, 0, 'COMMA', 0, 'POINT')}|"></p>
                   </div>

                   <!-- Actions -->
                   <div class="item-actions">
                       <!-- Add to Cart Form -->
                       <form th:action="@{/cart/add}" method="post" onsubmit="return confirm('Thêm sản phẩm này vào giỏ hàng?');">
                           <input type="hidden" name="productId" th:value="${item.nctProduct.nctProductId}" />
                           <input type="hidden" name="quantity" value="1" />
                           <button type="submit" class="action-btn" title="Thêm vào giỏ hàng">
                               <i class="fas fa-cart-plus"></i>
                           </button>
                       </form>

                       <!-- Remove from Wishlist Form -->
                       <form th:action="@{/wishlist/remove/{productId}(productId=${item.nctProduct.nctProductId})}" method="post" onsubmit="return confirm('Xóa sản phẩm này khỏi danh sách yêu thích?');">
                           <button type="submit" class="action-btn" title="Xóa khỏi yêu thích">
                               <i class="fas fa-trash-alt"></i>
                           </button>
                       </form>
                   </div>
               </div>
           </div>
       </main>

       </body>
       </html>